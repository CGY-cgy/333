<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”¨æˆ·ç®¡ç† - çµå¢ƒç®¡ç†åå°</title>
    <link rel="stylesheet" href="common.css">
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
    <div class="admin-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <div class="sidebar-logo-icon"></div>
                    <div>
                        <div class="sidebar-logo-text">çµå¢ƒç®¡ç†</div>
                        <div class="sidebar-logo-sub">Admin Console</div>
                    </div>
                </div>
            </div>
            <nav>
                <div class="nav-section">
                    <div class="nav-section-title">ä¸»è¦åŠŸèƒ½</div>
                    <a href="dashboard.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“Š</span>
                        <span class="nav-item-text">æ•°æ®çœ‹æ¿</span>
                    </a>
                    <a href="users.html" class="nav-item active">
                        <span class="nav-item-icon">ğŸ‘¥</span>
                        <span class="nav-item-text">ç”¨æˆ·ç®¡ç†</span>
                    </a>
                    <a href="analytics.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ“ˆ</span>
                        <span class="nav-item-text">æ•°æ®åˆ†æ</span>
                    </a>
                    <a href="membership.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ’</span>
                        <span class="nav-item-text">ä¼šå‘˜åˆ†æ</span>
                    </a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">ç³»ç»Ÿç®¡ç†</div>
                    <a href="security.html" class="nav-item">
                        <span class="nav-item-icon">ğŸ”’</span>
                        <span class="nav-item-text">å®‰å…¨ç®¡ç†</span>
                    </a>
                    <a href="settings.html" class="nav-item">
                        <span class="nav-item-icon">âš™ï¸</span>
                        <span class="nav-item-text">ç³»ç»Ÿè®¾ç½®</span>
                    </a>
                    <a href="login.html" class="nav-item">
                        <span class="nav-item-icon">ğŸšª</span>
                        <span class="nav-item-text">é€€å‡ºç™»å½•</span>
                    </a>
                </div>
            </nav>
        </aside>

        <main class="main-content">
            <header class="header">
                <div>
                    <h1 class="header-title">ç”¨æˆ·ç®¡ç†</h1>
                    <p class="header-subtitle">ç®¡ç†å¹³å°ç”¨æˆ·è´¦æˆ·ä¸æƒé™</p>
                </div>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="exportExcel()">
                        <span>ğŸ“Š</span>
                        <span>å¯¼å‡ºExcel</span>
                    </button>
                </div>
            </header>

            <!-- æœç´¢å¡ç‰‡ -->
            <div class="card" style="margin-bottom: var(--spacing-lg); padding: var(--spacing-lg);">
                <h3 style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--spacing-md);">æœç´¢æ¡ä»¶</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: var(--spacing-md); margin-bottom: var(--spacing-md);">
                    <div class="form-group">
                        <label class="form-label">ç”¨æˆ·ID</label>
                        <input type="text" class="form-input" id="searchId" placeholder="è¯·è¾“å…¥ç”¨æˆ·ID">
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ‰‹æœºå·</label>
                        <input type="text" class="form-input" id="searchPhone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·">
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ˜µç§°</label>
                        <input type="text" class="form-input" id="searchNickname" placeholder="è¯·è¾“å…¥æ˜µç§°">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ä¼šå‘˜çŠ¶æ€</label>
                        <select class="form-select" id="searchMemberStatus">
                            <option value="">å…¨éƒ¨</option>
                            <option value="normal">æ™®é€šç”¨æˆ·</option>
                            <option value="vip">VIPä¼šå‘˜</option>
                            <option value="svip">SVIPä¼šå‘˜</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">è´¦æˆ·çŠ¶æ€</label>
                        <select class="form-select" id="searchAccountStatus">
                            <option value="">å…¨éƒ¨</option>
                            <option value="active">å·²å¯ç”¨</option>
                            <option value="inactive">å·²ç¦ç”¨</option>
                            <option value="banned">å·²å°ç¦</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: var(--spacing-md);">
                    <button class="btn btn-primary" onclick="searchUsers()">
                        <span>ğŸ”</span>
                        <span>æœç´¢</span>
                    </button>
                    <button class="btn btn-secondary" onclick="resetSearch()">
                        <span>ğŸ”„</span>
                        <span>é‡ç½®</span>
                    </button>
                </div>
            </div>

            <div class="card">
                <div style="margin-bottom: var(--spacing-md);">
                    <h3 style="font-size: 16px; font-weight: 600; color: var(--text-primary);">ç”¨æˆ·åˆ—è¡¨</h3>
                </div>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <th style="text-align: left; padding: var(--spacing-md); font-size: 13px; font-weight: 500; color: var(--text-secondary); background: var(--bg-tertiary);">ç”¨æˆ·</th>
                                <th style="text-align: left; padding: var(--spacing-md); font-size: 13px; font-weight: 500; color: var(--text-secondary); background: var(--bg-tertiary);">æ‰‹æœºå·</th>
                                <th style="text-align: left; padding: var(--spacing-md); font-size: 13px; font-weight: 500; color: var(--text-secondary); background: var(--bg-tertiary);">æ³¨å†Œæ—¶é—´</th>
                                <th style="text-align: left; padding: var(--spacing-md); font-size: 13px; font-weight: 500; color: var(--text-secondary); background: var(--bg-tertiary);">æœ€åç™»å½•</th>
                                <th style="text-align: left; padding: var(--spacing-md); font-size: 13px; font-weight: 500; color: var(--text-secondary); background: var(--bg-tertiary);">ä¼šå‘˜çŠ¶æ€</th>
                                <th style="text-align: left; padding: var(--spacing-md); font-size: 13px; font-weight: 500; color: var(--text-secondary); background: var(--bg-tertiary);">è´¦æˆ·çŠ¶æ€</th>
                                <th style="text-align: left; padding: var(--spacing-md); font-size: 13px; font-weight: 500; color: var(--text-secondary); background: var(--bg-tertiary);">æ“ä½œ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                                        <div style="width: 40px; height: 40px; border-radius: var(--border-radius-full); background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;">æ</div>
                                        <div>
                                            <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">ææ™“æ˜</div>
                                            <div style="font-size: 12px; color: var(--text-tertiary);">ID: 100001</div>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">138****1234</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-01-15 09:30</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-12-27 14:25</td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(118, 75, 162, 0.1); color: var(--secondary-color);">SVIP</span></td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(72, 187, 120, 0.1); color: var(--success-color);">å·²å¯ç”¨</span></td>
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; gap: var(--spacing-sm);">
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px;" title="æŸ¥çœ‹è¯¦æƒ…" onclick="viewUserDetail('100001')">ğŸ‘ï¸</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--warning-color);" title="é‡ç½®å¯†ç " onclick="resetPassword('100001')">ğŸ”‘</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--success-color);" title="åˆ‡æ¢çŠ¶æ€" onclick="toggleStatus('100001')">âš¡</button>
                                    </div>
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                                        <div style="width: 40px; height: 40px; border-radius: var(--border-radius-full); background: var(--success-color); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;">ç‹</div>
                                        <div>
                                            <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">ç‹èŠ³</div>
                                            <div style="font-size: 12px; color: var(--text-tertiary);">ID: 100002</div>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">139****5678</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-02-20 14:15</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-12-26 18:42</td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(255, 215, 0, 0.15); color: #B8860B;">VIP</span></td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(72, 187, 120, 0.1); color: var(--success-color);">å·²å¯ç”¨</span></td>
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; gap: var(--spacing-sm);">
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px;" title="æŸ¥çœ‹è¯¦æƒ…" onclick="viewUserDetail('100002')">ğŸ‘ï¸</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--warning-color);" title="é‡ç½®å¯†ç " onclick="resetPassword('100002')">ğŸ”‘</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--success-color);" title="åˆ‡æ¢çŠ¶æ€" onclick="toggleStatus('100002')">âš¡</button>
                                    </div>
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                                        <div style="width: 40px; height: 40px; border-radius: var(--border-radius-full); background: var(--warning-color); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;">å¼ </div>
                                        <div>
                                            <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">å¼ ä¼Ÿ</div>
                                            <div style="font-size: 12px; color: var(--text-tertiary);">ID: 100003</div>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">136****9012</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-03-10 08:45</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-12-27 10:18</td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: var(--bg-tertiary); color: var(--text-secondary);">æ™®é€šç”¨æˆ·</span></td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(72, 187, 120, 0.1); color: var(--success-color);">å·²å¯ç”¨</span></td>
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; gap: var(--spacing-sm);">
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px;" title="æŸ¥çœ‹è¯¦æƒ…" onclick="viewUserDetail('100003')">ğŸ‘ï¸</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--warning-color);" title="é‡ç½®å¯†ç " onclick="resetPassword('100003')">ğŸ”‘</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--success-color);" title="åˆ‡æ¢çŠ¶æ€" onclick="toggleStatus('100003')">âš¡</button>
                                    </div>
                                </td>
                            </tr>
                            <tr style="border-bottom: 1px solid var(--border-color);">
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                                        <div style="width: 40px; height: 40px; border-radius: var(--border-radius-full); background: var(--info-color); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;">åˆ˜</div>
                                        <div>
                                            <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">åˆ˜æ´‹</div>
                                            <div style="font-size: 12px; color: var(--text-tertiary);">ID: 100004</div>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">137****3456</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-04-05 16:30</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-12-25 22:15</td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(118, 75, 162, 0.1); color: var(--secondary-color);">SVIP</span></td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(237, 137, 54, 0.1); color: var(--warning-color);">å·²ç¦ç”¨</span></td>
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; gap: var(--spacing-sm);">
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px;" title="æŸ¥çœ‹è¯¦æƒ…" onclick="viewUserDetail('100004')">ğŸ‘ï¸</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--warning-color);" title="é‡ç½®å¯†ç " onclick="resetPassword('100004')">ğŸ”‘</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--success-color);" title="åˆ‡æ¢çŠ¶æ€" onclick="toggleStatus('100004')">âš¡</button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                                        <div style="width: 40px; height: 40px; border-radius: var(--border-radius-full); background: var(--danger-color); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;">é™ˆ</div>
                                        <div>
                                            <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">é™ˆé™</div>
                                            <div style="font-size: 12px; color: var(--text-tertiary);">ID: 100005</div>
                                        </div>
                                    </div>
                                </td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">135****7890</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-05-18 11:20</td>
                                <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">2024-12-27 08:55</td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(255, 215, 0, 0.15); color: #B8860B;">VIP</span></td>
                                <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; background: rgba(245, 101, 101, 0.1); color: var(--danger-color);">å·²å°ç¦</span></td>
                                <td style="padding: var(--spacing-md);">
                                    <div style="display: flex; gap: var(--spacing-sm);">
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px;" title="æŸ¥çœ‹è¯¦æƒ…" onclick="viewUserDetail('100005')">ğŸ‘ï¸</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--warning-color);" title="é‡ç½®å¯†ç " onclick="resetPassword('100005')">ğŸ”‘</button>
                                        <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--success-color);" title="åˆ‡æ¢çŠ¶æ€" onclick="toggleStatus('100005')">âš¡</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: var(--spacing-lg); padding-top: var(--spacing-md); border-top: 1px solid var(--border-color); flex-wrap: wrap; gap: var(--spacing-md);">
                    <div style="font-size: 14px; color: var(--text-secondary);">å…± 1,234 æ¡è®°å½•ï¼Œæ¯é¡µ 10 æ¡</div>
                    <div style="display: flex; gap: var(--spacing-sm);">
                        <button class="btn btn-secondary btn-sm" disabled style="opacity: 0.5;">ä¸Šä¸€é¡µ</button>
                        <button class="btn btn-primary btn-sm">1</button>
                        <button class="btn btn-secondary btn-sm">2</button>
                        <button class="btn btn-secondary btn-sm">3</button>
                        <span style="padding: 6px 10px; color: var(--text-secondary);">...</span>
                        <button class="btn btn-secondary btn-sm">124</button>
                        <button class="btn btn-secondary btn-sm">ä¸‹ä¸€é¡µ</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ç”¨æˆ·è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="modal-overlay" id="userDetailModal">
        <div class="modal">
            <div style="display: flex; justify-content: space-between; align-items: center; padding: var(--spacing-lg); border-bottom: 1px solid var(--border-color);">
                <h3 style="font-size: 18px; font-weight: 600; color: var(--text-primary);">ç”¨æˆ·è¯¦æƒ…</h3>
                <button class="btn btn-secondary btn-sm" style="padding: 8px; border-radius: var(--border-radius-full);" onclick="closeModal()">âœ•</button>
            </div>
            <div style="padding: var(--spacing-lg);">
                <div style="display: flex; align-items: center; gap: var(--spacing-md); margin-bottom: var(--spacing-lg); padding-bottom: var(--spacing-md); border-bottom: 1px solid var(--border-color);">
                    <div style="width: 80px; height: 80px; border-radius: var(--border-radius-full); background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 28px;">æ</div>
                    <div>
                        <h4 style="font-size: 20px; font-weight: 600; color: var(--text-primary); margin-bottom: var(--spacing-xs);">ææ™“æ˜</h4>
                        <div style="display: flex; gap: var(--spacing-md); font-size: 14px; color: var(--text-secondary);">
                            <span>ID: 100001</span>
                            <span>138****1234</span>
                        </div>
                    </div>
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-md); margin-bottom: var(--spacing-lg);">
                    <div style="background: var(--bg-tertiary); padding: var(--spacing-md); border-radius: var(--border-radius-md);">
                        <div style="font-size: 12px; color: var(--text-tertiary); margin-bottom: 4px;">æ³¨å†Œæ—¶é—´</div>
                        <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">2024-01-15 09:30</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: var(--spacing-md); border-radius: var(--border-radius-md);">
                        <div style="font-size: 12px; color: var(--text-tertiary); margin-bottom: 4px;">æœ€åç™»å½•</div>
                        <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">2024-12-27 14:25</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: var(--spacing-md); border-radius: var(--border-radius-md);">
                        <div style="font-size: 12px; color: var(--text-tertiary); margin-bottom: 4px;">ä¼šå‘˜çŠ¶æ€</div>
                        <div style="font-size: 14px; font-weight: 500; color: var(--secondary-color);">SVIPä¼šå‘˜</div>
                    </div>
                    <div style="background: var(--bg-tertiary); padding: var(--spacing-md); border-radius: var(--border-radius-md);">
                        <div style="font-size: 12px; color: var(--text-tertiary); margin-bottom: 4px;">è´¦æˆ·çŠ¶æ€</div>
                        <div style="font-size: 14px; font-weight: 500; color: var(--success-color);">å·²å¯ç”¨</div>
                    </div>
                </div>
                <div style="background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05)); padding: var(--spacing-lg); border-radius: var(--border-radius-lg);">
                    <div style="display: flex; align-items: center; gap: var(--spacing-md); margin-bottom: var(--spacing-md);">
                        <div style="width: 80px; height: 80px; border-radius: var(--border-radius-full); background: var(--success-color); display: flex; align-items: center; justify-content: center; color: white; font-size: 24px; font-weight: 700;">92</div>
                        <div>
                            <h4 style="font-size: 18px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px;">å¥åº·è¯„åˆ†</h4>
                            <p style="font-size: 14px; color: var(--text-secondary);">åŸºäºèˆŒåƒå’Œé—®å·çš„ç»¼åˆè¯„ä¼°</p>
                        </div>
                    </div>
                    <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-sm);">
                        <span style="padding: 6px 12px; background: var(--primary-color); color: white; border-radius: 20px; font-size: 13px; font-weight: 500;">å¹³å’Œè´¨</span>
                        <span style="padding: 6px 12px; background: rgba(102, 126, 234, 0.1); color: var(--primary-color); border-radius: 20px; font-size: 13px; font-weight: 500;">æ°”è™šè´¨</span>
                        <span style="padding: 6px 12px; background: rgba(102, 126, 234, 0.1); color: var(--primary-color); border-radius: 20px; font-size: 13px; font-weight: 500;">é˜³è™šè´¨</span>
                    </div>
                </div>
            </div>
            <div style="display: flex; justify-content: flex-end; gap: var(--spacing-md); padding: var(--spacing-lg); border-top: 1px solid var(--border-color);">
                <button class="btn btn-secondary" onclick="closeModal()">å…³é—­</button>
                <button class="btn btn-primary" onclick="openEditModal(currentViewedUserId)">ä¿®æ”¹ä¿¡æ¯</button>
                <button class="btn btn-warning">é‡ç½®å¯†ç </button>
                <button class="btn btn-danger">å°ç¦è´¦æˆ·</button>
            </div>
        </div>
    </div>

    <!-- ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æ¨¡æ€æ¡† -->
    <div class="modal-overlay" id="editUserModal">
        <div class="modal" style="max-width: 600px;">
            <div style="display: flex; justify-content: space-between; align-items: center; padding: var(--spacing-lg); border-bottom: 1px solid var(--border-color);">
                <h3 style="font-size: 18px; font-weight: 600; color: var(--text-primary);">ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯</h3>
                <button class="btn btn-secondary btn-sm" style="padding: 8px; border-radius: var(--border-radius-full);" onclick="closeEditModal()">âœ•</button>
            </div>
            <div style="padding: var(--spacing-lg);">
                <form id="editUserForm">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--spacing-md); margin-bottom: var(--spacing-lg);">
                        <div class="form-group">
                            <label class="form-label">ç”¨æˆ·ID</label>
                            <input type="text" class="form-input" id="editUserId" readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å§“å</label>
                            <input type="text" class="form-input" id="editUserName" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">æ‰‹æœºå·</label>
                            <input type="tel" class="form-input" id="editUserPhone" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">ä¼šå‘˜çŠ¶æ€</label>
                            <select class="form-select" id="editUserMemberStatus" required>
                                <option value="normal">æ™®é€šç”¨æˆ·</option>
                                <option value="vip">VIPä¼šå‘˜</option>
                                <option value="svip">SVIPä¼šå‘˜</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">è´¦æˆ·çŠ¶æ€</label>
                            <select class="form-select" id="editUserAccountStatus" required>
                                <option value="active">å·²å¯ç”¨</option>
                                <option value="inactive">å·²ç¦ç”¨</option>
                                <option value="banned">å·²å°ç¦</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">å¥åº·è¯„åˆ†</label>
                            <input type="number" class="form-input" id="editUserHealthScore" min="0" max="100" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ä½“è´¨ç±»å‹</label>
                        <div style="display: flex; flex-wrap: wrap; gap: var(--spacing-sm); margin-top: var(--spacing-sm);">
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="å¹³å’Œè´¨" style="margin: 0;">
                                <span>å¹³å’Œè´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="æ°”è™šè´¨" style="margin: 0;">
                                <span>æ°”è™šè´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="é˜³è™šè´¨" style="margin: 0;">
                                <span>é˜³è™šè´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="é˜´è™šè´¨" style="margin: 0;">
                                <span>é˜´è™šè´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="ç—°æ¹¿è´¨" style="margin: 0;">
                                <span>ç—°æ¹¿è´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="æ¹¿çƒ­è´¨" style="margin: 0;">
                                <span>æ¹¿çƒ­è´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="è¡€ç˜€è´¨" style="margin: 0;">
                                <span>è¡€ç˜€è´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="æ°”éƒè´¨" style="margin: 0;">
                                <span>æ°”éƒè´¨</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 6px; padding: 8px 16px; background: var(--bg-tertiary); border-radius: 20px; cursor: pointer;">
                                <input type="checkbox" name="constitution" value="ç‰¹ç¦€è´¨" style="margin: 0;">
                                <span>ç‰¹ç¦€è´¨</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div style="display: flex; justify-content: flex-end; gap: var(--spacing-md); padding: var(--spacing-lg); border-top: 1px solid var(--border-color);">
                <button class="btn btn-secondary" onclick="closeEditModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveUserChanges()">ä¿å­˜ä¿®æ”¹</button>
            </div>
        </div>
    </div>

    <script>
        // ç”¨æˆ·æ•°æ®
        const users = [
            { id: '100001', name: 'ææ™“æ˜', phone: '138****1234', fullPhone: '13812341234', memberStatus: 'svip', accountStatus: 'active', registerTime: '2024-01-15 09:30', lastLogin: '2024-12-27 14:25', healthScore: 92, constitution: ['å¹³å’Œè´¨', 'æ°”è™šè´¨', 'é˜³è™šè´¨'] },
            { id: '100002', name: 'ç‹èŠ³', phone: '139****5678', fullPhone: '13956785678', memberStatus: 'vip', accountStatus: 'active', registerTime: '2024-02-20 14:15', lastLogin: '2024-12-26 18:42', healthScore: 85, constitution: ['ç—°æ¹¿è´¨', 'é˜´è™šè´¨'] },
            { id: '100003', name: 'å¼ ä¼Ÿ', phone: '136****9012', fullPhone: '13690129012', memberStatus: 'normal', accountStatus: 'active', registerTime: '2024-03-10 08:45', lastLogin: '2024-12-27 10:18', healthScore: 78, constitution: ['æ¹¿çƒ­è´¨', 'è¡€ç˜€è´¨'] },
            { id: '100004', name: 'åˆ˜æ´‹', phone: '137****3456', fullPhone: '13734563456', memberStatus: 'svip', accountStatus: 'inactive', registerTime: '2024-04-05 16:30', lastLogin: '2024-12-25 22:15', healthScore: 88, constitution: ['å¹³å’Œè´¨', 'æ°”éƒè´¨'] },
            { id: '100005', name: 'é™ˆé™', phone: '135****7890', fullPhone: '13578907890', memberStatus: 'vip', accountStatus: 'banned', registerTime: '2024-05-18 11:20', lastLogin: '2024-12-27 08:55', healthScore: 80, constitution: ['ç—°æ¹¿è´¨', 'æ¹¿çƒ­è´¨', 'è¡€ç˜€è´¨'] },
            { id: '100006', name: 'èµµå¼º', phone: '134****2345', fullPhone: '13423452345', memberStatus: 'normal', accountStatus: 'active', registerTime: '2024-06-25 13:45', lastLogin: '2024-12-27 09:30', healthScore: 75, constitution: ['æ°”è™šè´¨', 'é˜³è™šè´¨'] },
            { id: '100007', name: 'å­™ä¸½', phone: '133****6789', fullPhone: '13367896789', memberStatus: 'svip', accountStatus: 'active', registerTime: '2024-07-12 10:20', lastLogin: '2024-12-26 16:45', healthScore: 95, constitution: ['å¹³å’Œè´¨', 'é˜´è™šè´¨'] },
            { id: '100008', name: 'å‘¨æ°', phone: '132****0123', fullPhone: '13201230123', memberStatus: 'vip', accountStatus: 'active', registerTime: '2024-08-30 15:10', lastLogin: '2024-12-27 11:20', healthScore: 82, constitution: ['ç—°æ¹¿è´¨', 'æ°”éƒè´¨'] },
            { id: '100009', name: 'å´æ•', phone: '131****4567', fullPhone: '13145674567', memberStatus: 'normal', accountStatus: 'active', registerTime: '2024-09-18 09:50', lastLogin: '2024-12-25 14:30', healthScore: 79, constitution: ['æ¹¿çƒ­è´¨', 'é˜³è™šè´¨'] },
            { id: '100010', name: 'éƒ‘å', phone: '130****8901', fullPhone: '13089018901', memberStatus: 'svip', accountStatus: 'active', registerTime: '2024-10-22 14:25', lastLogin: '2024-12-27 13:15', healthScore: 90, constitution: ['å¹³å’Œè´¨', 'è¡€ç˜€è´¨'] }
        ];

        // å½“å‰æ˜¾ç¤ºçš„ç”¨æˆ·åˆ—è¡¨
        let currentUsers = [...users];
        let currentPage = 1;
        const pageSize = 5;
        let currentViewedUserId = '';

        // æ¸²æŸ“ç”¨æˆ·åˆ—è¡¨
        function renderUsers(usersToRender = currentUsers) {
            const tbody = document.querySelector('table tbody');
            tbody.innerHTML = '';

            const startIndex = (currentPage - 1) * pageSize;
            const endIndex = startIndex + pageSize;
            const pageUsers = usersToRender.slice(startIndex, endIndex);

            pageUsers.forEach(user => {
                const tr = document.createElement('tr');
                tr.style.borderBottom = '1px solid var(--border-color)';
                
                let memberStatusText = '';
                let memberStatusColor = '';
                if (user.memberStatus === 'svip') {
                    memberStatusText = 'SVIP';
                    memberStatusColor = 'background: rgba(118, 75, 162, 0.1); color: var(--secondary-color);';
                } else if (user.memberStatus === 'vip') {
                    memberStatusText = 'VIP';
                    memberStatusColor = 'background: rgba(255, 215, 0, 0.15); color: #B8860B;';
                } else {
                    memberStatusText = 'æ™®é€šç”¨æˆ·';
                    memberStatusColor = 'background: var(--bg-tertiary); color: var(--text-secondary);';
                }

                let accountStatusText = '';
                let accountStatusColor = '';
                if (user.accountStatus === 'active') {
                    accountStatusText = 'å·²å¯ç”¨';
                    accountStatusColor = 'background: rgba(72, 187, 120, 0.1); color: var(--success-color);';
                } else if (user.accountStatus === 'inactive') {
                    accountStatusText = 'å·²ç¦ç”¨';
                    accountStatusColor = 'background: rgba(237, 137, 54, 0.1); color: var(--warning-color);';
                } else {
                    accountStatusText = 'å·²å°ç¦';
                    accountStatusColor = 'background: rgba(245, 101, 101, 0.1); color: var(--danger-color);';
                }

                tr.innerHTML = `
                    <td style="padding: var(--spacing-md);">
                        <div style="display: flex; align-items: center; gap: var(--spacing-md);">
                            <div style="width: 40px; height: 40px; border-radius: var(--border-radius-full); background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; font-size: 14px;">${user.name.charAt(0)}</div>
                            <div>
                                <div style="font-size: 14px; font-weight: 500; color: var(--text-primary);">${user.name}</div>
                                <div style="font-size: 12px; color: var(--text-tertiary);">ID: ${user.id}</div>
                            </div>
                        </div>
                    </td>
                    <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">${user.phone}</td>
                    <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">${user.registerTime}</td>
                    <td style="padding: var(--spacing-md); font-size: 14px; color: var(--text-primary);">${user.lastLogin}</td>
                    <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; ${memberStatusColor};">${memberStatusText}</span></td>
                    <td style="padding: var(--spacing-md);"><span style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 500; ${accountStatusColor};">${accountStatusText}</span></td>
                    <td style="padding: var(--spacing-md);">
                        <div style="display: flex; gap: var(--spacing-sm);">
                            <button class="btn btn-secondary btn-sm" style="padding: 6px 10px;" title="æŸ¥çœ‹è¯¦æƒ…" onclick="viewUserDetail('${user.id}')">ğŸ‘ï¸</button>
                            <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--warning-color);" title="é‡ç½®å¯†ç " onclick="resetPassword('${user.id}')">ğŸ”‘</button>
                            <button class="btn btn-secondary btn-sm" style="padding: 6px 10px; color: var(--success-color);" title="åˆ‡æ¢çŠ¶æ€" onclick="toggleStatus('${user.id}')">âš¡</button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(tr);
            });

            // æ›´æ–°åˆ†é¡µä¿¡æ¯
            updatePagination(usersToRender);
        }

        // æ›´æ–°åˆ†é¡µä¿¡æ¯
        function updatePagination(usersToRender = currentUsers) {
            const totalUsers = usersToRender.length;
            const totalPages = Math.ceil(totalUsers / pageSize);
            
            // æ›´æ–°æ€»è®°å½•æ•°æ˜¾ç¤º
            const totalText = document.querySelector('.card > div:last-child > div:first-child');
            if (totalText) {
                totalText.textContent = `å…± ${totalUsers.toLocaleString()} æ¡è®°å½•ï¼Œæ¯é¡µ ${pageSize} æ¡`;
            }
            
            // æ›´æ–°åˆ†é¡µæŒ‰é’®
            const paginationContainer = document.querySelector('.card > div:last-child > div:last-child');
            if (paginationContainer) {
                paginationContainer.innerHTML = '';
                
                // ä¸Šä¸€é¡µæŒ‰é’®
                const prevButton = document.createElement('button');
                prevButton.className = 'btn btn-secondary btn-sm';
                prevButton.textContent = 'ä¸Šä¸€é¡µ';
                prevButton.disabled = currentPage === 1;
                prevButton.onclick = () => goToPage(currentPage - 1);
                paginationContainer.appendChild(prevButton);
                
                // é¡µç æŒ‰é’®
                const maxVisiblePages = 5;
                let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
                let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
                
                if (endPage - startPage + 1 < maxVisiblePages) {
                    startPage = Math.max(1, endPage - maxVisiblePages + 1);
                }
                
                if (startPage > 1) {
                    const firstPageButton = document.createElement('button');
                    firstPageButton.className = 'btn btn-secondary btn-sm';
                    firstPageButton.textContent = '1';
                    firstPageButton.onclick = () => goToPage(1);
                    paginationContainer.appendChild(firstPageButton);
                    
                    if (startPage > 2) {
                        const ellipsis1 = document.createElement('span');
                        ellipsis1.textContent = '...';
                        ellipsis1.style.padding = '6px 10px';
                        ellipsis1.style.color = 'var(--text-secondary)';
                        paginationContainer.appendChild(ellipsis1);
                    }
                }
                
                for (let i = startPage; i <= endPage; i++) {
                    const pageButton = document.createElement('button');
                    pageButton.className = `btn btn-sm ${i === currentPage ? 'btn-primary' : 'btn-secondary'}`;
                    pageButton.textContent = i;
                    pageButton.onclick = () => goToPage(i);
                    paginationContainer.appendChild(pageButton);
                }
                
                if (endPage < totalPages) {
                    if (endPage < totalPages - 1) {
                        const ellipsis2 = document.createElement('span');
                        ellipsis2.textContent = '...';
                        ellipsis2.style.padding = '6px 10px';
                        ellipsis2.style.color = 'var(--text-secondary)';
                        paginationContainer.appendChild(ellipsis2);
                    }
                    
                    const lastPageButton = document.createElement('button');
                    lastPageButton.className = 'btn btn-secondary btn-sm';
                    lastPageButton.textContent = totalPages;
                    lastPageButton.onclick = () => goToPage(totalPages);
                    paginationContainer.appendChild(lastPageButton);
                }
                
                // ä¸‹ä¸€é¡µæŒ‰é’®
                const nextButton = document.createElement('button');
                nextButton.className = 'btn btn-secondary btn-sm';
                nextButton.textContent = 'ä¸‹ä¸€é¡µ';
                nextButton.disabled = currentPage === totalPages;
                nextButton.onclick = () => goToPage(currentPage + 1);
                paginationContainer.appendChild(nextButton);
            }
        }

        // è·³è½¬åˆ°æŒ‡å®šé¡µç 
        function goToPage(page) {
            const totalPages = Math.ceil(currentUsers.length / pageSize);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderUsers();
            }
        }

        // æœç´¢ç”¨æˆ·åŠŸèƒ½
        function searchUsers() {
            const searchId = document.getElementById('searchId').value.trim();
            const searchPhone = document.getElementById('searchPhone').value.trim();
            const searchNickname = document.getElementById('searchNickname').value.trim();
            const searchMemberStatus = document.getElementById('searchMemberStatus').value;
            const searchAccountStatus = document.getElementById('searchAccountStatus').value;

            currentUsers = users.filter(user => {
                // å¦‚æœæ‰€æœ‰æœç´¢æ¡ä»¶éƒ½ä¸ºç©ºï¼Œåˆ™æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·
                if (!searchId && !searchPhone && !searchNickname && !searchMemberStatus && !searchAccountStatus) {
                    return true;
                }
                
                // ORé€»è¾‘ï¼šåªéœ€æ»¡è¶³ä¸€ä¸ªæ¡ä»¶å³å¯åŒ¹é…
                let match = false;

                if (searchId && user.id.includes(searchId)) {
                    match = true;
                }

                if (searchPhone && user.fullPhone.includes(searchPhone)) {
                    match = true;
                }

                if (searchNickname && user.name.includes(searchNickname)) {
                    match = true;
                }

                if (searchMemberStatus && user.memberStatus === searchMemberStatus) {
                    match = true;
                }

                if (searchAccountStatus && user.accountStatus === searchAccountStatus) {
                    match = true;
                }

                return match;
            });

            currentPage = 1;
            renderUsers(currentUsers);
        }

        function resetSearch() {
            document.getElementById('searchId').value = '';
            document.getElementById('searchPhone').value = '';
            document.getElementById('searchNickname').value = '';
            document.getElementById('searchMemberStatus').value = '';
            document.getElementById('searchAccountStatus').value = '';
            
            currentUsers = [...users];
            currentPage = 1;
            renderUsers();
        }

        function viewUserDetail(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            // ä¿å­˜å½“å‰æŸ¥çœ‹çš„ç”¨æˆ·ID
            currentViewedUserId = userId;

            const modal = document.getElementById('userDetailModal');
            
            // æ›´æ–°ç”¨æˆ·å¤´åƒå’ŒåŸºæœ¬ä¿¡æ¯
            const avatar = modal.querySelector('.modal > div:nth-child(2) > div:nth-child(1) > div:nth-child(1)');
            if (avatar) {
                avatar.textContent = user.name.charAt(0);
            }
            
            const userName = modal.querySelector('.modal > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > h4');
            if (userName) {
                userName.textContent = user.name;
            }
            
            const userInfo = modal.querySelectorAll('.modal > div:nth-child(2) > div:nth-child(1) > div:nth-child(2) > div > span');
            if (userInfo.length >= 2) {
                userInfo[0].textContent = `ID: ${user.id}`;
                userInfo[1].textContent = user.phone;
            }
            
            // æ›´æ–°ç”¨æˆ·è¯¦æƒ…ä¿¡æ¯
            const detailDivs = modal.querySelectorAll('.modal > div:nth-child(2) > div:nth-child(2) > div');
            if (detailDivs.length >= 4) {
                // æ³¨å†Œæ—¶é—´
                const registerTimeDiv = detailDivs[0].querySelector('div:last-child');
                if (registerTimeDiv) {
                    registerTimeDiv.textContent = user.registerTime;
                }
                
                // æœ€åç™»å½•
                const lastLoginDiv = detailDivs[1].querySelector('div:last-child');
                if (lastLoginDiv) {
                    lastLoginDiv.textContent = user.lastLogin;
                }
                
                // ä¼šå‘˜çŠ¶æ€
                const memberStatusDiv = detailDivs[2].querySelector('div:last-child');
                if (memberStatusDiv) {
                    const memberStatusText = user.memberStatus === 'svip' ? 'SVIPä¼šå‘˜' : user.memberStatus === 'vip' ? 'VIPä¼šå‘˜' : 'æ™®é€šç”¨æˆ·';
                    memberStatusDiv.textContent = memberStatusText;
                    memberStatusDiv.style.color = user.memberStatus === 'svip' ? 'var(--secondary-color)' : user.memberStatus === 'vip' ? '#B8860B' : 'var(--text-secondary)';
                }
                
                // è´¦æˆ·çŠ¶æ€
                const accountStatusDiv = detailDivs[3].querySelector('div:last-child');
                if (accountStatusDiv) {
                    const accountStatusText = user.accountStatus === 'active' ? 'å·²å¯ç”¨' : user.accountStatus === 'inactive' ? 'å·²ç¦ç”¨' : 'å·²å°ç¦';
                    accountStatusDiv.textContent = accountStatusText;
                    accountStatusDiv.style.color = user.accountStatus === 'active' ? 'var(--success-color)' : user.accountStatus === 'inactive' ? 'var(--warning-color)' : 'var(--danger-color)';
                }
            }
            
            // æ›´æ–°å¥åº·è¯„åˆ†
            const healthScoreDiv = modal.querySelector('.modal > div:nth-child(2) > div:nth-child(3) > div:nth-child(1) > div:nth-child(1)');
            if (healthScoreDiv) {
                healthScoreDiv.textContent = user.healthScore;
            }
            
            // æ›´æ–°ä½“è´¨ç±»å‹æ ‡ç­¾
            const constitutionContainer = modal.querySelector('.modal > div:nth-child(2) > div:nth-child(3) > div:nth-child(2)');
            if (constitutionContainer) {
                constitutionContainer.innerHTML = '';
                user.constitution.forEach(constitution => {
                    const span = document.createElement('span');
                    span.style.padding = '6px 12px';
                    span.style.background = constitution === 'å¹³å’Œè´¨' ? 'var(--primary-color)' : 'rgba(102, 126, 234, 0.1)';
                    span.style.color = constitution === 'å¹³å’Œè´¨' ? 'white' : 'var(--primary-color)';
                    span.style.borderRadius = '20px';
                    span.style.fontSize = '13px';
                    span.style.fontWeight = '500';
                    span.textContent = constitution;
                    constitutionContainer.appendChild(span);
                });
            }
            
            // æ›´æ–°æ¨¡æ€æ¡†ä¸­çš„æŒ‰é’®åŠŸèƒ½
            const modalButtons = modal.querySelectorAll('.modal > div:nth-child(3) > button');
            if (modalButtons.length >= 3) {
                // é‡ç½®å¯†ç æŒ‰é’®
                modalButtons[1].onclick = () => {
                    resetPassword(userId);
                    closeModal();
                };
                
                // å°ç¦/è§£å°è´¦æˆ·æŒ‰é’®
                modalButtons[2].onclick = () => {
                    banUser(userId);
                    closeModal();
                };
                
                // æ›´æ–°å°ç¦/è§£å°æŒ‰é’®æ–‡æœ¬
                const accountStatusText = user.accountStatus === 'active' || user.accountStatus === 'inactive' ? 'å°ç¦è´¦æˆ·' : 'è§£å°è´¦æˆ·';
                modalButtons[2].textContent = accountStatusText;
            }
            
            // æ˜¾ç¤ºæ¨¡æ€æ¡†
            modal.classList.add('show');
        }

        // æ‰“å¼€ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æ¨¡æ€æ¡†
        function openEditModal(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            // å¡«å……è¡¨å•æ•°æ®
            document.getElementById('editUserId').value = user.id;
            document.getElementById('editUserName').value = user.name;
            document.getElementById('editUserPhone').value = user.fullPhone;
            document.getElementById('editUserMemberStatus').value = user.memberStatus;
            document.getElementById('editUserAccountStatus').value = user.accountStatus;
            document.getElementById('editUserHealthScore').value = user.healthScore;
            
            // é‡ç½®å¹¶å‹¾é€‰ä½“è´¨ç±»å‹
            const checkboxes = document.querySelectorAll('input[name="constitution"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = user.constitution.includes(checkbox.value);
            });
            
            // æ˜¾ç¤ºä¿®æ”¹æ¨¡æ€æ¡†
            const editModal = document.getElementById('editUserModal');
            editModal.classList.add('show');
        }

        // å…³é—­ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯æ¨¡æ€æ¡†
        function closeEditModal() {
            const editModal = document.getElementById('editUserModal');
            editModal.classList.remove('show');
        }

        // ä¿å­˜ç”¨æˆ·ä¿®æ”¹
        function saveUserChanges() {
            const userId = document.getElementById('editUserId').value;
            const user = users.find(u => u.id === userId);
            if (!user) return;
            
            // è·å–è¡¨å•æ•°æ®
            const name = document.getElementById('editUserName').value;
            const fullPhone = document.getElementById('editUserPhone').value;
            const memberStatus = document.getElementById('editUserMemberStatus').value;
            const accountStatus = document.getElementById('editUserAccountStatus').value;
            const healthScore = parseInt(document.getElementById('editUserHealthScore').value);
            
            // è·å–é€‰ä¸­çš„ä½“è´¨ç±»å‹
            const selectedConstitutions = [];
            const checkboxes = document.querySelectorAll('input[name="constitution"]:checked');
            checkboxes.forEach(checkbox => {
                selectedConstitutions.push(checkbox.value);
            });
            
            // éªŒè¯æ‰‹æœºå·æ ¼å¼
            const phoneRegex = /^1[3-9]\d{9}$/;
            if (!phoneRegex.test(fullPhone)) {
                alert('è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·æ ¼å¼');
                return;
            }
            
            // æ›´æ–°ç”¨æˆ·æ•°æ®
            user.name = name;
            user.fullPhone = fullPhone;
            user.phone = fullPhone.replace(/(\d{3})\d{4}(\d{4})/, '$1****$2');
            user.memberStatus = memberStatus;
            user.accountStatus = accountStatus;
            user.healthScore = healthScore;
            user.constitution = selectedConstitutions;
            
            // æ›´æ–°å½“å‰ç”¨æˆ·åˆ—è¡¨
            const index = currentUsers.findIndex(u => u.id === userId);
            if (index !== -1) {
                currentUsers[index] = {...user};
            }
            
            // é‡æ–°æ¸²æŸ“ç”¨æˆ·åˆ—è¡¨
            renderUsers();
            
            // å…³é—­ä¿®æ”¹æ¨¡æ€æ¡†
            closeEditModal();
            
            // å…³é—­è¯¦æƒ…æ¨¡æ€æ¡†
            closeModal();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            alert('ç”¨æˆ·ä¿¡æ¯ä¿®æ”¹æˆåŠŸï¼');
        }

        function resetPassword(userId) {
            if (confirm('ç¡®å®šè¦ä¸ºè¯¥ç”¨æˆ·é‡ç½®å¯†ç å—ï¼Ÿ')) {
                // æ¨¡æ‹Ÿé‡ç½®å¯†ç 
                setTimeout(() => {
                    alert('å¯†ç é‡ç½®æˆåŠŸï¼æ–°å¯†ç ä¸ºï¼š123456');
                }, 1000);
            }
        }

        function toggleStatus(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;

            let newStatus = '';
            if (user.accountStatus === 'active') {
                newStatus = 'inactive';
            } else if (user.accountStatus === 'inactive') {
                newStatus = 'active';
            } else {
                newStatus = 'active';
            }

            if (confirm(`ç¡®å®šè¦å°†ç”¨æˆ·çŠ¶æ€ä»${user.accountStatus === 'active' ? 'å·²å¯ç”¨' : user.accountStatus === 'inactive' ? 'å·²ç¦ç”¨' : 'å·²å°ç¦'}åˆ‡æ¢ä¸º${newStatus === 'active' ? 'å·²å¯ç”¨' : newStatus === 'inactive' ? 'å·²ç¦ç”¨' : 'å·²å°ç¦'}å—ï¼Ÿ`)) {
                // æ¨¡æ‹ŸçŠ¶æ€åˆ‡æ¢
                user.accountStatus = newStatus;
                renderUsers();
                alert('çŠ¶æ€åˆ‡æ¢æˆåŠŸï¼');
            }
        }

        function closeModal() {
            const modal = document.getElementById('userDetailModal');
            modal.classList.remove('show');
        }

        // å°ç¦/è§£å°ç”¨æˆ·åŠŸèƒ½
        function banUser(userId) {
            const user = users.find(u => u.id === userId);
            if (!user) return;

            let newStatus = '';
            let actionText = '';
            if (user.accountStatus === 'active' || user.accountStatus === 'inactive') {
                newStatus = 'banned';
                actionText = 'å°ç¦';
            } else {
                newStatus = 'active';
                actionText = 'è§£å°';
            }

            if (confirm(`ç¡®å®šè¦${actionText}è¯¥ç”¨æˆ·å—ï¼Ÿ`)) {
                // æ¨¡æ‹Ÿå°ç¦/è§£å°æ“ä½œ
                user.accountStatus = newStatus;
                renderUsers();
                alert(`${actionText}æˆåŠŸï¼`);
            }
        }

        document.addEventListener('click', function(e) {
            const modal = document.getElementById('userDetailModal');
            if (e.target === modal) {
                closeModal();
            }
            
            const editModal = document.getElementById('editUserModal');
            if (e.target === editModal) {
                closeEditModal();
            }
        });

        // å¯¼å‡ºExcelåŠŸèƒ½
        function exportExcel() {
            // å‡†å¤‡å¯¼å‡ºçš„æ•°æ®
            const exportData = currentUsers.map(user => ({
                'ç”¨æˆ·ID': user.id,
                'å§“å': user.name,
                'æ‰‹æœºå·': user.fullPhone,
                'ä¼šå‘˜çŠ¶æ€': user.memberStatus === 'svip' ? 'SVIP' : user.memberStatus === 'vip' ? 'VIP' : 'æ™®é€šç”¨æˆ·',
                'è´¦æˆ·çŠ¶æ€': user.accountStatus === 'active' ? 'å·²å¯ç”¨' : user.accountStatus === 'inactive' ? 'å·²ç¦ç”¨' : 'å·²å°ç¦',
                'æ³¨å†Œæ—¶é—´': user.registerTime,
                'æœ€åç™»å½•': user.lastLogin,
                'å¥åº·è¯„åˆ†': user.healthScore,
                'ä½“è´¨ç±»å‹': user.constitution.join(', ')
            }));

            // åˆ›å»ºå·¥ä½œç°¿å’Œå·¥ä½œè¡¨
            const workbook = XLSX.utils.book_new();
            const worksheet = XLSX.utils.json_to_sheet(exportData);

            // è®¾ç½®åˆ—å®½
            const colWidths = [
                { wch: 10 }, // ç”¨æˆ·ID
                { wch: 10 }, // å§“å
                { wch: 15 }, // æ‰‹æœºå·
                { wch: 12 }, // ä¼šå‘˜çŠ¶æ€
                { wch: 12 }, // è´¦æˆ·çŠ¶æ€
                { wch: 20 }, // æ³¨å†Œæ—¶é—´
                { wch: 20 }, // æœ€åç™»å½•
                { wch: 10 }, // å¥åº·è¯„åˆ†
                { wch: 25 }  // ä½“è´¨ç±»å‹
            ];
            worksheet['!cols'] = colWidths;

            // å°†å·¥ä½œè¡¨æ·»åŠ åˆ°å·¥ä½œç°¿
            XLSX.utils.book_append_sheet(workbook, worksheet, 'ç”¨æˆ·åˆ—è¡¨');

            // ç”ŸæˆExcelæ–‡ä»¶å¹¶ä¸‹è½½
            const fileName = `ç”¨æˆ·åˆ—è¡¨_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(workbook, fileName);
        }

        // åˆå§‹åŒ–é¡µé¢
        document.addEventListener('DOMContentLoaded', function() {
            renderUsers();
        });
    </script>
</body>
</html>
